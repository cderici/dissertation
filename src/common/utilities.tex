% \todo[<heading>]{<optional note>}
%   <heading>  – short title that shows in small caps (default: TODO)
%   <note>     – anything you want to remember (optional)
\NewTColorBox{todo}{O{Todo}}
  {enhanced,
   colback=white,          % interior left plain
   colframe=red!70!black,  % visible red border
   boxrule=1pt,            % border thickness
   sharp corners,          % square corners
   width=\linewidth,       % full text width
   enlarge top by=0.5\baselineskip,
   enlarge bottom by=0.5\baselineskip,
   title=\textsc{#1},      % small-caps heading
   before skip=1em, after skip=1em}

\NewTColorBox{paragraph-here}{O{Paragraph}}
  {enhanced,
   colback=white,          % interior left plain
   colframe=red!70!black,  % visible red border
   boxrule=1pt,            % border thickness
   sharp corners,          % square corners
   width=\linewidth,       % full text width
   enlarge top by=0.5\baselineskip,
   enlarge bottom by=0.5\baselineskip,
   title=\textsc{#1},      % small-caps heading
   before skip=1em, after skip=1em}

   \NewTColorBox{show-experiment}{O{Show Experiment}}
  {enhanced,
   colback=white,          % interior left plain
   colframe=lime!70!black,  % visible red border
   boxrule=1pt,            % border thickness
   sharp corners,          % square corners
   width=\linewidth,       % full text width
   enlarge top by=0.5\baselineskip,
   enlarge bottom by=0.5\baselineskip,
   title=\textsc{#1},      % small-caps heading
   before skip=1em, after skip=1em}

\NewTColorBox{mainpoint}{O{Main Point}}
  {enhanced,
   colback=white,          % interior left plain
   colframe=blue!70!black,  % visible red border
   boxrule=1pt,            % border thickness
   sharp corners,          % square corners
   width=\linewidth,       % full text width
   enlarge top by=0.5\baselineskip,
   enlarge bottom by=0.5\baselineskip,
   title=\textsc{#1},      % small-caps heading
   before skip=1em, after skip=1em}

\NewTColorBox{sectionpoint}{O{Section Main Point}}
  {enhanced,
   colback=white,          % interior left plain
   colframe=blue!70!black,  % visible red border
   boxrule=1pt,            % border thickness
   sharp corners,          % square corners
   width=\linewidth,       % full text width
   enlarge top by=0.5\baselineskip,
   enlarge bottom by=0.5\baselineskip,
   title=\textsc{#1},      % small-caps heading
   before skip=1em, after skip=1em}

\NewTColorBox{chaptersynopsis}{O{Chapter Synopsis}}
  {enhanced,
    colback=white,            % interior left plain
    colframe=purple!70!black,  % visible red border
    boxrule=1pt,              % border thickness
    sharp corners,            % square corners
    width=\linewidth,         % full text width
    enlarge top by=0.5\baselineskip,
    enlarge bottom by=0.5\baselineskip,
    fontupper=\small,
    title=\textsc{#1},      % small-caps heading
    before skip=1em,
    after skip=1em,
    after=\par\newpage
  }



\lstset{
  % --- Linenos ---
  numbersep=20pt,                  % how far the line-numbers are from the code
  numberstyle=\small\color{gray},
  numbers=left,                   % where to put the line-numbers
  stepnumber=1,                   % the step between two line-numbers. If it is 1 each line will be numbered
  % -- Basics --
  basicstyle=\ttfamily,
  sensitive=true,  % Case-sensitive keywords
  tabsize=2,
  breaklines=true,  % Break lines if too long
  %escapechar=`,
  %escapeinside={<@}{@>},
  % I don't know what keepspaces and columns do, but together, they fix the ugly default listings style.
  columns=fullflexible,
  keepspaces,
  showstringspaces=false,  % Spaces not shown as _
  frame            = single,
  framerule        = 0.5pt,
  rulecolor        = \color{black},
  framesep         = 10pt,
  framexleftmargin = 0pt,
  framexrightmargin= 0pt,
}

\definecolor{ForestGreen}{RGB}{64,139,64}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% RPython TRACE lang
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\lstdefinelanguage{rptrace}{
  morecomment=[l]{\#},
  morestring=[b]",
  commentstyle={\color{ForestGreen}\slshape\sffamily},
  sensitive=false,
  keywords={
      int_add, int_eq, int_lt, strgetitem,
      getfield_gc_r, getfield_gc_i
  },
  classoffset=1,
    morekeywords={
      guard_true, guard_false,
    },
    keywordstyle=\color{red},
  classoffset=2,
    morekeywords={
      label, jump,
    },
    keywordstyle=\color{blue},
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% RACKET lang
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\lstdefinelanguage{racket} {
  % -- Comments --
  %morecomment=[l]{//},
  %morecomment=[s]{/*}{*/},
  morecomment=[l]{;},         % Inline comments start with ;
  morecomment=[s]{\#|}{|\#},  % Block comments are done with #|  |#
  commentstyle={\color{ForestGreen}\slshape\sffamily},
  % -- Strings --
  morestring=[b]",
  stringstyle=\color{red},
  % --- Literal replacements ---
  literate=%
  %	{lambda}{{$\lambda$}}1
    {->}{{$\rightarrow$}}1
    {*}{{$\times$}}1,
  % -- Keywords (I got these from a vague French website; Racket seems to have no lstlisting style defined anywhere) --
  classoffset=1,
    morekeywords={
      define, define-syntax, define-macro, define-datatype, lambda, define-stream, stream-lambda
    },
    keywordstyle=\color{blue},
  classoffset=2,
    morekeywords={
      begin, call-with-current-continuation, call/cc, call-with-input-file, call-with-output-file,
      cases, cond, do, else, for, time, for-each, if,
      let*, let, let-syntax, letrec, letrec-syntax,
      define-context, define-controller, Integer, Boolean, get, when-required, when-provided,
      maybe_publish, require, submod, or/c, ->, \#\%module-begin, always_publish, with-syntax, define-struct/contract, syntax-case, define/contract,
      let-values, let*-values,
      module, provide,
      and, or, not,
      delay, force, in-range, regexp-match,
      \#`, \#',
      null, cons, car, cdr, cadr, caddr,
      \#lang, implement, begin-for-syntax, rename-out,
      quasiquote, quote, unquote, unquote-splicing,
      map, filter, foldl, syntax, syntax-rules, eval, environment, query
    },
    keywordstyle=\color{blue},
  classoffset=3,
    morekeywords={import, export},
    keywordstyle=\color{green},
  classoffset=0,
  alsoletter={',`,-,/,>,<,\#,\%},
  moredelim=**[is][\color{lightgray}]{<<@<<}{>>@>>},
  moredelim=**[is][\itshape\color{OliveGreen}]{<<;<<}{>>;>>},
}

